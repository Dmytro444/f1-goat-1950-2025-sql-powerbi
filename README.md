# F1 GOAT 1950-2025
Data analysis project aimed at determining the best Formula 1 driver for the period 1950-2025 using a custom approach.

Since a driver's career in Formula 1 usually lasts no longer than 20 years whereas Formula 1 as a competition has already been existing for 76 seasons, there is a never-ending debate between Formula 1 fans about which driver(s) should be considered as the greatest of all time. The best way to settle such a debate would be giving equal cars to all of the drivers who ever competed in the sport and letting them race for at least a few races on different tracks with different configurations in different weather conditions. However, no track present in current F1 calendar would fit as many cars as there have been race winners across the entire history (115 for the period 1950-2025), let alone total number of drivers who ever appeared on the starting grid (almost 800), to let them race properly and safely. Besides, most of the drivers finished their racing careers long time ago or passed away, therefore a direct competition on track between all of them would be impossible anyways. Luckily, data has been an integral part of Formula 1 since the beginning, and the only way to compare drivers' performance considering different eras is to use historical data and try to transform them to a "common denominator". To implement the above idea in this project, the following indicators have been analyzed:
- biggest Drivers' Championship's points tally (i.e. the one earning a driver a championship title) each year using 4 different approaches:
  1) actual points awarded to championship's tally as per points system applicable at the time (including points for fastest laps and/or sprint races, some races did not count to championship's tally - see [List of Formula One World Championship points scoring systems used throughout history](https://en.wikipedia.org/wiki/List_of_Formula_One_points_systems#Points_scoring_systems) for more details;
  2) sum of points for all races (points for fastest laps and sprint races not included) as per points system applicable at the time;
  3) sum of points for all races (points for fastest laps and sprint races not included) as per the most relevant points system (applicable since 2010). Full points awarded for shortened races as well, although if a car was shared by multiple drivers during the race, then divided accordingly (applicable for 1950-1957);
  4) sum of points for all races (points for fastest laps and sprint races not included) as per custom-made points system where top-15 drivers who finished a race receive points from 15 to 1 (decision on number of drivers receiving points explained later in Step 1). Full points awarded for shortened races as well, although if a car was shared by multiple drivers during the race, then divided accordingly (applicable for 1950-1957);
- biggest number of Championship titles as per each of the aforementioned points systems;
- highest average finishing position (for drivers with at least 20 race entries across at least 3 seasons);
- biggest advantage of a driver over their teammates across entire career (for drivers with at least 10 races when both them and at least one of their teammates finished, across at least 3 seasons).
  
BONUS: finding relations and trends between average age of drivers competing on a particular day and age of champions, race winners and points scorers.

## Tech stack
- SQL (data extraction, joins, aggregations);
- Excel + VBA (data enrichment, manual review of exceptions, pivot chart);
- Power Query (ETL, data cleaning, advanced grouping and aggregation, creating summary table with total score for each driver based on results of analysis as per key performance parameters);
- Power BI (data model, DAX measures).

## Initial data source
[Open Source Formula 1 Database](https://github.com/f1db/f1db), release v2025.24.2

## STEP 0 - Preliminary checks of data consistency between tables of the database
- **number of seasons held vs total number of championship titles won by all drivers** (see files "0.1. Seasons vs Championships check - SQL query" and "0.1. Seasons vs Championships check - query result");
- **number of races held vs total number of race wins for all drivers** (see files "0.2. Races vs Wins check - SQL query" and "0.2. Races vs Wins check - query result"). Since a discrepancy was found, further analysis was conducted to make sure the data in the database matches actual results (see files "0.2.1. Finding races with more than 1 winner - SQL query", "0.2.1. Finding races with more than 1 winner - query result" and "0.2.1. Finding races with more than 1 winner - Backup info");
- **number of podiums achieved by all drivers vs total number of race finishes in positions 1-3** (see files "0.3. Podiums check - SQL query" and "0.3. Podiums check - query result"). Since a discrepancy was found, further analysis was conducted to make sure the data in the database matches actual results (see files "0.3.1. Finding drivers with discrepancies in podium finishes - SQL query", "0.3.1. Finding drivers with discrepancies in podium finishes - query result", "0.3.1. Finding drivers with discrepancies in podium finishes - Backup info 1" and "0.3.1. Finding drivers with discrepancies in podium finishes - Backup info 2").

## STEP 1 - Generating main dataset, enriching it and reviewing exceptions
Generated dataset (see files "1. Generating main dataset for further analysis - SQL query" and "1. Dataset initial") gathers results of all the traditional grand prix races ever held (1149 as of the end of 2025 season) for all the drivers who entered those races, including information such as grand prix official names, dates when they were held, drivers' finishing positions, starting grid positions, qualification positions and dates of birth, constructors they represented along with engine and tyre suppliers as well as points the drivers were awarded after each race. Total number of records is 27291. Eventually part of those data were not used in the presented project, however can be utilised for further analysis on a different level (e.g. comparing performance of different constructors, engine suppliers and tyre manufacturers throughout history).  
Based on finishing position of each driver in each race, additional columns have been created to assign drivers points based on currently applicable system and on custom-made system where the first 15 drivers classified in each race receive points from 15 to 1.
> [!NOTE]
> In order to determine number of drivers in each race who should receive points as per custom-made system, number of drivers starting each race (see files "1.1. Finding number of drivers starting each race - SQL query" and "1.1. Number of drivers starting each race.csv") has been analysed. As a result, it has been found out that only 12 races out of 1149 ever held had less than 15 cars on the grid, whereas almost 90% had 20+ drivers starting (see file "1.1. Number of drivers starting each race.xlsx", tab "Chart"), therefore it has been decided that top-15 drivers deserve points to be awarded to them.

The points have been calculated using two separate procedures created in VBA based on For...Next loop containing Select Case decision structure. Afterwards, the instances of multiple drivers having the same finishing position in the same race (186 records) and the same drivers having different finishing positions in the same race (184 records) have been reviewed manually and points in the additional columns have been adjusted accordingly. Updated dataset used in the final data model is available in the file "1. Dataset", tab "1. Dataset".

## STEP 2 - Adding the main dataset to the data model in Power BI, creating derivative queries aggregating data, exporting additional data from the database, creating dashboards
After loading the dataset to the model, it has been slightly cleaned and transformed in Power Query (rounded off values in the fields with points as per different systems, replaced "null" values with 0, added column with year for each race using relevant function, got rid of a few columns which were deemed unnecessary for further analysis). The cleaned-up query ("0_RaceResults") was later used as a basis for derivative queries aggregating data in a more advanced manner.  

### Dashboard 1 - Champions as per different pts systems
The idea for the first dashboard was to compare champion's points each season as per different points systems:
- actual points counted towards championship applicable at the time;
- total race points as per system applicable at the time;
- total race points as per current points system;
- total race points if top-15 finishers received points 15â†’1.

Since some races did not count to driver's championship's tally during 1950-1990 (see [List of Formula One World Championship points scoring systems used throughout history](https://en.wikipedia.org/wiki/List_of_Formula_One_points_systems#Points_scoring_systems) for more details), it has become clear that the mentioned earlier dataset with race results alone would not be sufficient to show short summary for the first option, therefore additional data has been extracted from the database (see files "2. Generating list of actual champions per year with actual points - SQL query" and "2. List of actual champions per year with actual points") and added to the data model (query "0_ListOfActualChampionsPerYearWithActualPoints").  
Derivative queries "1_PointsChampionActualSystem", "1_PointsChampionCurrentSystem" and "1_PointsChampionTop15" have been created to determine which driver had the biggest sum of race points each year and therefore should be deemed as champion as per alternative scoring systems: each driver has been given a rank for each year using the relevant function in Power Query, and eventually only information regarding drivers with Rank = 1 was left. During data transformation it turned out that multiple drivers would have had the same biggest amount of points in a couple of seasons based on current points system and the custom-made one. The sole winner in all these cases was decided the same way it would be decided in current Formula 1: based on who of the contenders had the most wins that season (if equal, then who has the most 2nd places and so on) - results of the comparison available in the file "1. Dataset", tab "Tied Title Fights - check".  
The comparison of champion's points tallies as per each approach along with champion's name in each case is presented in a form of 4 table visuals. Since there are some significant differences in total champion's points between different seasons, it was decided to add dynamic card visual to show number of races held depending on year(s) chosen in any of the table visuals - relevant DAX measure has been created based on the main dataset with race results.

### Dashboard 2 - Most titles as per different pts systems
The next step was checking whether list of drivers with multiple championship titles would look differently if alternative points scoring systems were applicable throughout entire history and how top-10 drivers who scored the most points during their entire careers would look like in each case.  
For this purpose, the data from the queries "0_ListOfActualChampionsPerYearWithActualPoints", "1_PointsChampionActualSystem", "1_PointsChampionCurrentSystem" and "1_PointsChampionTop15" were combined (appended) into query "11_ChampionsPointsAsPerDifferentSystems" to let the slicer visual on the page "Most titles as per different pts systems" of the Power BI file "F1 GOAT 1950-2025" show the data accordingly. Besides, the data regarding champions' points in their winning seasons only would not have been sufficient to determine top-10 points-scorers of all time, therefore additional data has been extracted from the database (see files "3. Generating summary of points by driver per year with race starts - SQL query" and "3. Summary of points by driver per year with race starts") and added to the data model (query "2_PointsActualSystemC"), and derivative queries "2_PointsActualSystem", "2_PointsCurrentSystem" and "2_PointsTop15" were created. The three latter aggregated sum of points earned by each driver each year, and relevant points scoring system was assigned to each of them. Afterwards, the above 4 queries have been combined (appended) into query "21_TotalCareerPointsAsPerDifferentSystems" with data grouped by driver and by points system to let the slicer visual on the page "Most titles as per different pts systems" of the Power BI file "F1 GOAT 1950-2025" show the data accordingly. Another visual on the aforementioned page - "Championship Years" card - lists years when a driver selected from the clustered bar chart would have been deemed champion as per different approaches.

### Dashboard 3 - Average finishing position
The next dashboard's purpose is to show drivers with the highest average finishing position across their entire career (or during the year range selected via slicer visual) compared to average number of drivers who finished the races the driver participated in. It also shows number of race entries for each of those drivers: the more entries a driver had - the more times they had to prove their high level of performance to maintain high average position.  
The line and clustered column chart visual uses data from the main dataset (query "0_RaceResults") as well as "Average Drivers finished" DAX measure based on it. The results have been limited via relevant filters on the visual to drivers who only have participated in at least 20 races across at least 3 seasons - this threshold has been chosen as representative to focus only on drivers who had multiple opportunities in different conditions to prove their worth as a Formula 1 driver.  
The card visual "First Season and Last Season" is based on two DAX measures calculated based on data from the main dataset and shows first and last season a driver chosen from the line and clustered column chart visual competed in unless different year range is chosen in a slicer visual.  
The other three gauge visuals present ratios of the chosen driver's race finishes to race entries, wins to race finishes and podiums to race finishes to give an idea whether a driver had a lot of DNFs during their career and how many races which they were able to finish they managed to convert into prize-winning positions. To calculate wins and podiums, DAX measures were used.

### Dashboard 4 - Advantage over teammates
Since there were a lot of drivers throughout Formula 1 history who never had an opportunity to drive race-winning cars, let alone championship-winning ones, and it is often said that the main benchmark for each driver in Formula 1 is their teammate, it is important to know which drivers had biggest advantage over their teammates across their entire career. In order to do so, it was decided to compare average finishing positions of drivers vs their teammates in respective races as well as show percentage of team battles won by a driver overall. It was also decided to include drivers' teammates names in the results of the analysis, to see whether any of the drivers had top-tier teammates during their careers - having advantage over those is even more valuable than beating an average opponent. The analysis was complicated by the fact that while for the past couple of decades each driver has had only one teammate each race, in the early stages of Formula 1 it was a common practice for teams to be represented by 3 or even 4 cars on the grid; on the other hand, there also were a lot of cases when a constructor was only represented by one car. Therefore, for the purpose of this analysis, a threshold of 10 races across 3 seasons was set for drivers - limitation similar to the one used in the "Average finishing position" dashboard, but with a couple of differences:
- only races where driver had teammates (at least one) who finished the same race have been taken into account for fair comparison;
- the minimum number of races to be considered in the sample was reduced by half comparing to the previous dashboard due to the fact that a lot of drivers had significant percentage of races not finished due to low reliability of machinery they were provided, crashes, disqualifications etc., and percentage of races where 100% of drivers representing a team finished a race is definitely lower than percentage of races completed by a driver alone regardless of their teammates.

First of all, a derivative query "3_H2HvsTeammates" has been created to transform the initial dataset in a way that it eventually shows whether a driver has higher finishing position in each race than their teammates or not. This has been achieved through implementation of the following steps:
- finding sum of finishing position of drivers representing the same team as the driver in the same race through grouping data by race and constructor, aggregating by sum, then deducting driver's finishing position from the rest;
- grouping the transformed data again by race and constructor, aggregating by number of rows to find out the number of drivers of the same team who finished the same race. The result deducted by 1 represents number of driver's teammates who finished the race. Rows where number of teammates was 0 were removed via filter;
- average finishing position of driver's teammates in a race is a quotient of the first number divided by the second one (sum of positions by number of teammates).

At this point query "3_H2HvsTeammates" was duplicated to another one named "3_Teammates each race" to aggregate list of drivers representing each team in each race. The data were grouped once again by race and by constructor, leaving only lists of drivers as a result of aggregation and extracting values of those lists afterwards.  
For both "3_H2HvsTeammates" and "3_Teammates each race" temporary key columns were created to perform merge of those two queries so that the former one has not only average position of driver's teammates in a race, but also their names. After the merge, the data in the column with list of teammates was cleaned from names of the drivers the relevant records were for using text functions of Power Query. Another column was added to represent whether a driver had finishing position higher than his teammates' average in the same race or not. In case it was the same (e.g. 3 drivers of the same team finished 1-2-3, and the analyzed driver finished 2nd), it was considered that the driver did not beat his teammates.  
At this stage, the query "3_H2HvsTeammates" was duplicated once again (query "31_TeammatesSummary") - this time to group the data by year and driver and evaluate average finishing position of each driver, average finishing position of their teammates, total number of teammates battles, number of teammates battles won by the driver, and consolidated list of their teammates for each season. Since those lists repeated the same drivers from different races, duplicates were removed using text functions of Power Query. Temporary "working" columns were removed.  
Transformed data from the "31_TeammatesSummary" query were used for the "Advantage over teammates" dashboard of the "F1 GOAT 1950-2025" file. A few DAX measures were created along the way - in particular, to show the biggest percentages of teammates battles won by drivers, list teammates in Tooltips section for each driver shown in the line and clustered column chart visual during each season and calculate sum of teammates battles won by each driver throughout entire career compared to total battles they had had reflected in the gauge visual.

### Dashboard 5 - Age vs success
As a bonus, it was decided to find out whether age has significant impact on drivers' performance or not, and how average age of drivers changed throughout the years. The analysis was performed on three levels:
- comparing champion's age on the day the title was decided for them vs average age of the drivers' lineup on the same day;
- comparing race winner's age on the day they won the race vs average age of the drivers' lineup on the same day;
- comparing average age of points scorers on the day they scored the points vs average age of the drivers' lineup on the same day.

First, in order to determine each season champion's age on the day the title fight was decided, the query "0_ListOfActualChampionsPerYearWithActualPoints" needed to be supplemented with data regarding relevant drivers' age. To make it possible, a derivative query "4_ChampionshipDecidersAge" was created based on the main dataset. Days and months of both race days and drivers' birth dates were extracted and expressed as the same dates from the closest leap year (2024) to avoid potential errors if any races or any drivers' birth dates took place on February 29th. Dates from 2024 matching drivers' birth dates were deducted from dates from 2024 matching dates when races were held: if the value was 0 or greater, driver's age in full years was calculated as difference between year when a race was held and year when the driver was born; if the value was less than 0, the difference in years from two dates was deducted by 1. Then, the calculated number of years was added to the driver's birth date to determine the date of their latest birthday as of the day of the race. The result was deducted from the date of the race - part of driver's age expressed in days precisely was received. Temporary "working" columns were removed, and data from the calculated columns expressing age in years and days separately was combined into the same field - those will later be used in the cards visuals in the "Age vs success" dashboard for user-friendly presentation, however, in order to make those ages comparable with each other in a chart, they should be expressed as decimals, therefore relevant column was added. The transformed dataset was cleared from records related to races which were not championship deciders via filter - age of drivers' lineup on each day the title was decided is ready. In order to add information regarding champions' age to the query "0_ListOfActualChampionsPerYearWithActualPoints", temporary key column was created in both queries. As a result of the merge of the queries, age of the 1970 champion was not populated, which makes sense since they did not participate in the race that year's title was decided, so the data for them was populated manually.  
The first visual for the dashboard in a form of area chart was added showing the comparison of champion's age on the day the title was decided for them vs average age of the drivers' lineup on the same day. Right next to it, a card visual was added to show age of youngest and oldest champion for the selected period. Tooltips contain information about relevant drivers' names and seasons when respective titles were won. DAX measures were created for all the data shown in the card.  
For the remaining visuals presenting comparison of race winners' age on the days they won races and average age of points scorers on the days they scored the points vs average age of the drivers' lineup on the same days, the data stored in the "4_DriversAge" query was used. This one is a duplicate of the "4_ChampionshipDecidersAge" query without a couple of extra steps (like filtering out races which were not championship decides of adding temporary key for linkage with another query). Information available in the Tooltips and in the cards was returned via DAX measures.

## SUMMARY
The data presented in the aforementioned dashboards alone should be sufficient for the majority of enthusiasts to make an informed decision on who can actually be considered the best Formula 1 driver of all time, however, I have decided to go a step further and invented a formula which allows to give each of the drivers meeting the criteria applied to data in "Average finishing position" and "Advantage over teammates" dashboards a score based on 3 performance parameters.  
The approach is explained in the file "Formula for calculation of rating". Input data for calculation is available in the files "Most titles - Actual", "Average finishing position" and "Advantage over teammates" - relevant data were exported directly from the Power BI report file. The Excel file "Summary" shows detailed results of the calculation, and the most important indicators are presented in the "Summary" page of the Power BI report file.
